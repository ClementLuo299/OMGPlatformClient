<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ListView?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.effect.DropShadow?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Pane?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.shape.Rectangle?>
<?import javafx.scene.text.Text?>

<BorderPane prefHeight="800.0" prefWidth="1400.0" styleClass="main-container" stylesheets="@../css/whist.css" xmlns="http://javafx.com/javafx/23.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="gui.controllers.games.WhistController">
    <!-- Top section with game info -->
    <top>
        <HBox alignment="CENTER" spacing="10" styleClass="game-header">
            <padding>
                <Insets bottom="10" left="15" right="15" top="10" />
            </padding>
            <Button fx:id="backButton" onAction="#onBackButtonClicked" styleClass="back-button" text="Back to Lobby" />
            <Text fx:id="gameTitle" styleClass="game-title" text="Whist" />
            <Pane HBox.hgrow="ALWAYS" /> <!-- Spacer -->
            
            <!-- Round Counter - Single Line -->
            <HBox alignment="CENTER" spacing="5" styleClass="info-indicator">
                <Label styleClass="info-label" text="Round:" />
                <Label fx:id="roundCounter" styleClass="info-value" text="1" />
            </HBox>
            
            <!-- Current Turn Indicator -->
            <HBox alignment="CENTER" spacing="5" styleClass="turn-indicator-container">
                <Label styleClass="turn-label" text="Current Turn:" />
                <Label fx:id="currentPlayerLabel" styleClass="current-player-label" text="Player 1" />
            </HBox>
            
            <!-- Move Timer -->
            <HBox alignment="CENTER" spacing="5" styleClass="timer-container">
                <Label styleClass="timer-label" text="Move Timer:" />
                <Label fx:id="timerLabel" styleClass="timer-value" text="00:30" />
            </HBox>
            
            <!-- Game Stage - Single Line -->
            <HBox alignment="CENTER" spacing="5" styleClass="info-indicator">
                <Label styleClass="info-label" text="Stage:" />
                <Label fx:id="gameStageLabel" styleClass="info-value" text="DEAL" />
            </HBox>
            
            <Pane HBox.hgrow="ALWAYS" /> <!-- Spacer -->
            <Label fx:id="statusLabel" styleClass="status-label" text="Game starting..." />
        </HBox>
    </top>
    
    <!-- Center section with game board -->
    <center>
        <StackPane alignment="CENTER">
            <!-- Table background -->
            <Rectangle arcHeight="50.0" arcWidth="50.0" fill="#0f743c" height="680.0" stroke="#006330" strokeType="INSIDE" strokeWidth="5.0" width="900.0" />
            
            <!-- Dealer Overlay -->
            <StackPane fx:id="dealerOverlay" maxHeight="500" maxWidth="400" styleClass="dealer-overlay">
                <effect>
                    <DropShadow color="#00000066" height="15" radius="7.0" spread="0.05" width="15" />
                </effect>
                <VBox alignment="CENTER" spacing="20" styleClass="dealer-content">
                    <padding>
                        <Insets bottom="30" left="30" right="30" top="30" />
                    </padding>
                    
                    <!-- Dealer Title -->
                    <Label fx:id="dealerTitle" styleClass="dealer-title" text="DEALER" />
                    
                    <!-- Card Image -->
                    <StackPane styleClass="card-image-container">
                        <effect>
                            <DropShadow color="#00000048" height="10" radius="4.5" width="10" />
                        </effect>
                        <ImageView fitHeight="280" fitWidth="200" preserveRatio="true">
                            <Image url="@../images/whist images/CardBackside1.png" />
                        </ImageView>
                    </StackPane>
                    
                    <!-- Instruction Text -->
                    <Label fx:id="shuffleInstructionLabel" styleClass="shuffle-instruction" text="Please Shuffle at least Three Times to Deal" textAlignment="CENTER" wrapText="true" />
                    
                    <!-- Shuffle Counter -->
                    <Label fx:id="shuffleCounterLabel" styleClass="shuffle-counter" text="Shuffles: 0/3" />
                    
                    <!-- Action Buttons -->
                    <HBox alignment="CENTER" spacing="15">
                        <Button fx:id="shuffleButton" styleClass="shuffle-button" text="Shuffle" />
                        <Button fx:id="dealButton" disable="true" styleClass="deal-button" text="Deal" />
                    </HBox>
                </VBox>
            </StackPane>
        </StackPane>
    </center>
   <left>
         <!-- Left Section: Game Controls and Player Info -->
         <VBox alignment="CENTER" spacing="15" styleClass="left-section" BorderPane.alignment="CENTER">
             <padding>
                 <Insets bottom="15" left="15" right="15" top="15" />
             </padding>
             
                <!-- Game Controls Section -->
             <VBox alignment="CENTER" spacing="10" styleClass="game-controls-section">
                 <padding>
                     <Insets bottom="15" left="15" right="15" top="15" />
                 </padding>
                 <Label styleClass="section-title" text="Game Controls" />
                 <Button fx:id="restartGameButton" styleClass="control-button, restart-button" text="Restart Game" />
                 <Button fx:id="forfeitGameButton" styleClass="control-button, forfeit-button" text="Forfeit Game" />
                 <Button fx:id="exitGameButton" styleClass="control-button, exit-button" text="Exit Game" />
             </VBox>
             
                <!-- Players Section -->
             <VBox alignment="CENTER" spacing="10" styleClass="players-section" VBox.vgrow="ALWAYS">
                 <padding>
                     <Insets bottom="15" left="15" right="15" top="15" />
                 </padding>
                 <Label styleClass="section-title" text="Players" />
                 
                    <!-- Match ID -->
                 <HBox alignment="CENTER" styleClass="match-id-container">
                     <Label styleClass="match-id-label" text="Match ID: " />
                     <Label fx:id="matchIdLabel" styleClass="match-id-value" text="M12345" />
                 </HBox>
                 
                    <!-- Player 1 -->
                 <VBox alignment="CENTER" styleClass="player-info, player-x-info">
                     <padding>
                         <Insets bottom="10" left="10" right="10" top="10" />
                     </padding>
                     <ImageView fx:id="player1Avatar" fitHeight="60" fitWidth="60" styleClass="player-avatar">
                         <Image url="@../images/singleplayer.png" />
                     </ImageView>
                     <Label fx:id="player1Name" styleClass="player-name" text="Player 1" />
                     <Label fx:id="player1Score" styleClass="player-score" text="Score: 0" />
                 </VBox>
                 
                    <!-- VS Label -->
                 <Label styleClass="vs-label" text="VS" />
                 
                    <!-- Player 2 -->
                 <VBox alignment="CENTER" styleClass="player-info, player-o-info">
                     <padding>
                         <Insets bottom="10" left="10" right="10" top="10" />
                     </padding>
                     <ImageView fx:id="player2Avatar" fitHeight="60" fitWidth="60" styleClass="player-avatar">
                         <Image url="@../images/singleplayer.png" />
                     </ImageView>
                     <Label fx:id="player2Name" styleClass="player-name" text="Player 2" />
                     <Label fx:id="player2Score" styleClass="player-score" text="Score: 0" />
                 </VBox>
             </VBox>
         </VBox>
   </left>
   <right>
         
            <!-- Right Section: Move History and In-Game Chat -->
         <VBox alignment="CENTER" spacing="15" styleClass="right-section" BorderPane.alignment="CENTER">
             <padding>
                 <Insets bottom="15" left="15" right="15" top="15" />
             </padding>
             
                <!-- Move History with modern design -->
             <VBox styleClass="move-history-section">
                 <padding>
                     <Insets bottom="12" left="15" right="15" top="12" />
                 </padding>
                 <HBox alignment="CENTER_LEFT" spacing="10">
                     <Label styleClass="section-title" text="Move History">
                         <HBox.margin>
                             <Insets bottom="5" right="10" top="0" />
                         </HBox.margin>
                     </Label>
                     <Pane HBox.hgrow="ALWAYS" /> <!-- Spacer -->
                     <Label fx:id="moveCountLabel" styleClass="move-count-label" text="Moves: 0" />
                 </HBox>
                 <ScrollPane fitToHeight="true" prefHeight="180" styleClass="move-history-container">
                     <ListView fx:id="moveHistoryList" styleClass="move-history-list" />
                 </ScrollPane>
             </VBox>
             
                <VBox alignment="CENTER" spacing="10" styleClass="chat-section" VBox.vgrow="ALWAYS">
                 <padding>
                     <Insets bottom="15" left="15" right="15" top="15" />
                 </padding>
            <VBox prefHeight="381.0" prefWidth="218.0">
               <children>
                       <HBox alignment="CENTER_LEFT" spacing="5">
                           <Label prefHeight="24.0" prefWidth="144.0" styleClass="section-title" text="In-Game Chat" /> <!-- Spacer -->
                           <Label fx:id="chatStatusLabel" styleClass="chat-status" text="Online" />
                       </HBox>
                        <Pane prefHeight="353.0" prefWidth="218.0" />
               </children>
            </VBox>
                 
                    <!-- Message Input Area -->
                 <HBox alignment="CENTER" spacing="8" styleClass="chat-input-container">
                     <TextField fx:id="chatInputField" promptText="Type your message..." styleClass="chat-input" HBox.hgrow="ALWAYS" />
                     <Button fx:id="sendMessageButton" onAction="#onSendChatClicked" styleClass="send-button" text="Send" />
                 </HBox>
             </VBox>
         </VBox>
   </right>
</BorderPane>
